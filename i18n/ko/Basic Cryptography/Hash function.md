## 소개

해시 함수는 입력의 크기와 상관없이 고정 크기의 해시 출력을 생성하는 함수입니다. 출력은 입력에 대한 고유 값이며, _해시 값, 다이제스트, 또는 단순히 해시_라고도 불립니다. 해시 함수는 다음과 같은 속성을 가집니다:

1. 결정적
2. 임의 길이의 입력
3. 고정 크기의 출력
4. 효율적으로 계산 가능

![[hash_function(1).png]]

(평문에서의 작은 변화가 다이제스트에서 큰 변화를 초래합니다.)

## 암호학적 해시 함수

특별한 속성을 가진 해시 함수를 **암호학적 해시 함수**라고 합니다. 이러한 특별한 특성은 다음과 같습니다:

1. **선행 이미지 저항성 (Pre-image resistance)**
   
   선행 이미지 저항성은 해시 값이 주어졌을 때, 해당 해시 값을 생성하는 입력을 찾는 것이 계산적으로 불가능하다는 것을 의미합니다. 기본적으로 $H(x)=h$인 $x$를 찾는 것이 매우 어려워야 합니다.

2. **두 번째 선행 이미지 저항성 (Second pre-image resistance)**
   
   두 번째 선행 이미지 저항성은 입력과 그 해시 값이 주어졌을 때, 동일한 해시 값을 생성하는 다른 입력을 찾는 것이 계산적으로 불가능하다는 것을 의미합니다. 기본적으로 주어진 $x$와 다른 $x'$를 찾아서 $H(x') = H(x)$가 되게 하는 것이 매우 어려워야 합니다.

3. **충돌 저항성 (Collision resistance)**

   충돌 저항성은 서로 다른 두 입력이 동일한 해시 값을 생성하는 것을 찾는 것이 계산적으로 불가능하다는 것을 의미합니다. 기본적으로 $H(x') = H(x)$가 되도록 하는 서로 다른 두 값 $x'$와 $x$를 찾는 것이 매우 어려워야 합니다. 이 속성을 만족시키기 위해 해시 값은 선행 이미지 저항성에 필요한 길이의 두 배여야 합니다.

또한, 암호학적 해시 함수는 [[one-way function]]으로 간주될 수 있습니다.

### 충돌 저항성에 대한 재미있는 사실

사실 충돌 저항성은 "충돌이 없다"는 것을 의미하지 않습니다. 이는 충돌을 **다항 시간** 내에 찾을 수 없다는 것을 의미합니다. 예를 들어, 이전에 인기 있던 해시 함수인 MD5와 SHA-1의 충돌이 각각 2007년과 2017년에 발견되었습니다. 아래 이미지는 내용은 다르지만 해시 값이 동일한 PDF 파일을 보여줍니다.

![[hash_function(2).png]]

따라서, 오늘날 인기 있는 SHA-2나 SHA-3와 같은 해시 함수는 **아직** 충돌이 발견되지 않았기 때문에 안전하다고 합니다. 또한, SHA-1, SHA-256 등의 해시 충돌을 찾아내면 비트코인 스크립트에서 보상도 주어집니다. [보상](https://bitcointalk.org/index.php?topic=293382.0)이 제공됩니다.

## 다양한 종류의 해시 함수

- SHA-256

  SHA-256은 SHA-2의 구현 중 하나입니다. SHA-256은 비트코인과 다른 곳에서 많이 사용됩니다.

- KECCAK-256

  KECCAK-256은 SHA-3의 구현입니다. 이더리움에서 사용됩니다.

## 사용 사례

### 데이터 구조

#### 해시 테이블 (Hash table)

해시 함수는 대형 데이터베이스에서 데이터의 빠른 검색을 위해 일반적으로 사용됩니다 (예: [Hash table](https://en.wikipedia.org/wiki/Hash_table)). 이 경우 사용되는 해시 함수는 암호학적으로 안전할 필요는 없습니다. 그러나 효율성을 위해 충돌이 적은 해시 함수를 사용하는 것이 권장됩니다.

#### Merkle 트리 (Merkle tree)

[[Merkle Tree]]는 각 리프 노드가 원래 값의 해시이며, 각 비리프 노드가 자식 노드의 해시인 이진 트리입니다. 루트 해시(Merkle Root)는 블록의 모든 트랜잭션을 나타냅니다. 이 구조는 포함 증명과 일관성 증명을 허용합니다.

### 네트워크

#### 메시지 무결성 (Message integrity)

메시지 무결성은 전송 전후의 해시 값을 비교하여 확인할 수 있습니다. 공격자가 원래 메시지를 위조할 수 있기 때문에 여기서는 암호학적 해시 함수가 필요합니다. [[PKI]](Public key infrastructure)에서는 발신자가 메시지와 메시지의 다이제스트에 서명하여 무결성을 보장합니다 ([[Digital signature]]).

### 블록체인

#### PoW(작업 증명) (Proof of Work)

[[PoW(Proof of Work)]]에서는 채굴자들이 암호학적 퍼즐을 해결하기 위해 경쟁합니다. 여기에는 [[Nonce]]를 찾는 과정이 포함됩니다. 논스는 블록 데이터와 결합되어 해시 함수를 통과하여 특정 조건을 만족하는 해시 값을 생성합니다.

#### 블록 헤더 (Block header)

블록체인의 각 블록은 블록 헤더와 트랜잭션 목록을 포함합니다. 블록 헤더에는 이전 블록의 해시, 타임스탬프, 논스가 포함됩니다. 이러한 블록의 연결은 데이터 무결성과 보안을 보장합니다.

#### 트랜잭션 ID (Transaction ID)

블록체인에서 트랜잭션 ID는 트랜잭션의 데이터를 해싱하여 생성됩니다. 이 고유한 해시는 트랜잭션의 식별자로 사용됩니다. 이는 각 트랜잭션이 고유하게 참조되고 검증될 수 있도록 보장합니다.
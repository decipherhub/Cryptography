## 소개

Schnorr signatures는 메시지를 서명하고 검증하는 안전한 방법을 제공하는 [[Digital Signature|디지털 서명]] 스킴의 한 종류입니다. Claus-Peter Schnorr에 의해 제안되었으며, 단순성, 효율성, 강력한 보안 속성으로 잘 알려져 있습니다. Schnorr 서명은 다른 서명 스킴과 비교했을 때 그 컴팩트한 크기와 계산 효율성으로 널리 인정받고 있습니다.

## 설계

Schnorr 서명의 설계는 암호학의 일반적인 어려운 문제인 [[Discrete logarithm problem|이산 로그 문제]]를 [[Cyclic Group|순환군]]에서 푸는 것의 난이도에 기반합니다. 이 스킴은 비밀키, 공개키, 서명 생성 및 검증 과정을 포함하는 세 가지 주요 구성 요소를 갖습니다. 비밀키는 무작위로 선택된 숫자이며, 공개키는 타원곡선의 미리 정의된 기준점이나 유한 체의 큰 소수를 사용하여 비밀키로부터 파생됩니다.

### 전역 매개변수 $(g, p, q)$

Schnorr 서명은 p-1이 **소인수 q**를 갖는 **소수 모듈로 p**와 함께 작동합니다. 일반적으로 p와 q의 적절한 크기는 각각 **1024비트와 160비트**입니다. 양 당사자는 $Z_p^*$ 그룹과 그 순환 부분군 $Z_p^*$에 동의해야 하며, 생성자는 $g$로 $g^q ≡ 1 \mod p$을 만족해야 합니다.

## 작동 방식

### 대화형 버전 (Schnorr Identification Protocol)

![[schnorr_signature(1).png]]

1. **키 생성**: 증명자는 무작위 정수를 선택하여 비밀키 $\omega$를 생성합니다. 해당 공개키 $x$는 $x = g^\omega\mod p$로 계산됩니다.
2. **커밋**
   - 증명자는 무작위 값 $r$을 선택하고 $a = g^r \mod p$를 계산하여 검증자에게 $a$를 보냅니다.
3. **도전**
   - 검증자는 증명자에게 무작위 도전 숫자 $c$를 보냅니다.
   - 증명자는 응답 $z = r + c\omega \mod q$를 계산합니다.
   - $q$는 [[Cyclic Subgroup|순환 부분군]]의 차수이며, $p-1$을 나눕니다. ($q$는 소수)
4. **검증**
   - 검증자는 $g^z \mod p$가 $a \cdot x^c \mod p$와 같은지 확인합니다.
   - 여기서, $a \cdot x^c = g^r \cdot x^c = g^r \cdot g^{\omega c} = g^{r + \omega c} = g^z \mod p$가 성립합니다.
   - 따라서, 이 동일성이 성립하면 서명은 유효하고, 그렇지 않으면 무효입니다.

이 검증은 증명자가 비밀키 $x$를 알고 있음을 증명하면서도 비밀키 자체를 공개하지 않음을 보장합니다. 이러한 이유로 이 프로토콜은 [[Zero Knowledge Proofs|제로 지식 프로토콜]] 중 하나로 간주될 수 있습니다.

### 비대화형 버전 (Schnorr Signature)

Schnorr 프로토콜의 대화형 버전은 Fiat-Shamir 변환을 사용하여 비대화형 버전으로 수정할 수 있습니다. 이를 Schnorr 서명이라고 하며, 그 과정은 다음과 같은 단계로 이루어집니다:

![[schnorr_signature(2).png]]

1. **키 생성**: 증명자는 무작위 정수를 선택하여 비밀키 $\omega$를 생성합니다. 해당 공개키 $x$는 $x = g^\omega\mod p$로 계산됩니다.
2. **서명 생성**: 메시지 $m$에 서명하려면, 서명자는:
   - 무작위 값 $r$을 선택하고 $a = g^r \mod p$를 계산합니다.
   - 해시 $e = H(m \| a)$를 계산합니다. 여기서 $H$는 암호화 해시 함수입니다.
   - 서명 $z = r + c\omega \mod q$를 계산합니다. 메시지 $m$에 대한 서명은 쌍 $(r, s)$입니다.
3. **서명 검증**: 메시지 $m$에 대한 서명 $(r, s)$를 검증하려면:
   - 검증자는 $e = H(m \| a)$를 계산합니다.
   - $g^z \mod p$가 $a \cdot x^c \mod p$와 같은지 확인합니다.
   - 동일성이 성립하면 서명은 유효하고, 그렇지 않으면 무효입니다.

이는 서명이 비밀키 $x$의 지식을 가진 사람에 의해서만 생성될 수 있음을 보장합니다.
## 소개

AES(Advanced Encryption Standard)는 가장 일반적인 [[Symmetric key encryption|대칭 키 암호화]] 알고리즘으로, 블록 암호를 활용합니다. [[DES]]와 달리 AES 알고리즘은 [[Feistel network|Feistel 네트워크]]를 사용하지 않아 더 많은 병렬 처리가 가능합니다. AES에서 사용되는 키의 길이는 128비트, 192비트 또는 256비트일 수 있으며, AES-128, AES-192, AES-256으로 나타낼 수 있습니다. 각 버전은 각각 10, 12, 14 라운드로 구성됩니다. 또한, 모든 AES 버전은 128비트의 동일한 블록 크기를 사용합니다. AES는 $4 \times 4$ 블록 배열로 작동하며, 여기서 각 $b_a$는 블록의 1바이트를 나타냅니다.

$$
\left[ 
\begin{matrix} 
b_0 & b_1 & b_2 & b_3 \\ 
b_4 & b_5 & b_6 & b_7 \\ 
b_8 & b_9 & b_{10} & b_{11} \\ 
b_{12} & b_{13} & b_{14} & b_{15} \\ 
\end{matrix} 
\right]
$$

## 설계

AES의 고수준 설명은 다음과 같습니다:

1. KeyExpansion
2. 초기 라운드
   - AddRoundKey
3. 다른 라운드(9, 11, 13 라운드)
   - SubBytes
   - ShiftRows
   - MixColumns
   - AddRoundKey
4. 최종 라운드
   - SubBytes
   - ShiftRows
   - AddRoundKey

### KeyExpansion

KeyExpansion 단계는 각 라운드에서 사용될 라운드 키를 생성합니다. AES-128의 경우 KeyExpansion은 128비트 키를 입력으로 받아 44워드 배열로 확장하며, 각 워드는 32비트입니다. 매 4개의 워드(128비트)는 각 라운드의 라운드 키로 사용되며, 이는 AES-128이 11개의 라운드 키를 사용함을 의미합니다. AES-192와 AES-256은 각각 13개와 15개의 라운드 키를 사용합니다. 각 라운드 키는 아래와 같이 표현됩니다.

$$
\left[ 
\begin{matrix} 
k_0 & k_1 & k_2 & k_3 \\ 
k_4 & k_5 & k_6 & k_7 \\ 
k_8 & k_9 & k_{10} & k_{11} \\ 
k_{12} & k_{13} & k_{14} & k_{15} \\ 
\end{matrix} 
\right]
$$

### AddRoundKey

AddRoundKey 단계는 상태 배열과 라운드 키 간의 간단한 비트별 XOR 연산입니다. 상태 배열은 암호화 과정에서 조작되는 $4 \times 4$ 평문 배열로, 첫 번째 라운드에서 사용됩니다. 각 라운드 키는 KeyExpansion 과정을 통해 원래 암호화 키에서 파생됩니다. 이 단계는 상태에 키를 추가하여 암호화의 보안을 제공합니다.

### SubBytes

SubBytes 단계는 각 바이트를 8비트 대체 상자(Sbox)에 따라 다른 바이트로 대체합니다. S-box는 [[Finite Field|GF]]($2^8$)에서 곱셈 역원을 활용하여 비선형 특성을 제공합니다.

![[AES(1).png]]

### ShiftRows

ShiftRows 단계는 상태 배열의 행을 일정 오프셋만큼 왼쪽으로 순환적으로 이동하는 전치 단계입니다. 첫 번째 행은 변경되지 않고, 두 번째 행은 왼쪽으로 한 바이트 이동하며, 세 번째 행은 두 바이트, 네 번째 행은 세 바이트 이동합니다. 이 단계는 각 행의 바이트 위치를 혼합하여 **확산(diffusion)**을 돕습니다.

![[AES(2).png]]

### MixColumns

MixColumns 단계는 상태 배열의 열에 작용하는 혼합 작업입니다. 각 열은 4항 다항식으로 취급되어 고정 다항식 $c(z)={03}_{16}\cdot z^{3}+{01}_{16}\cdot z^{2}+{01}_{16}\cdot z+{02}_{16}$로 곱해지며, $x^4 + 1$로 모듈로 연산됩니다. 일반적으로, 이 단계는 아래와 같이 표현될 수 있습니다.

![[AES(3).png]]

이 단계는 각 열 내의 바이트를 혼합하여 **확산(diffusion)**을 제공하며, 출력 바이트가 여러 입력 바이트에 의해 영향을 받도록 합니다.

![[AES(4).png]]